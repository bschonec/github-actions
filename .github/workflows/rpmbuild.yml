---

# NOTE!  The *calling* workflow must have necessary
#   permissions:
#     contents: write
# if you expect to upload artifacts.

name: Build RPM packages

permissions:
  contents: write 
on:
  push:
  workflow_call:
    inputs:
      specfile:
        description: The name of the rpm spec file to use.
        default: 'ant.spec'
        required: false
        type: string
      version:
        description: 'Version of package to be released. Must be a valid semver string without leading v. (eg: 1.2.3)'
        default: ''
        required: false
        type: string
      working-directory:
        description: The working directory where all jobs should be executed. Used for modules in subdirectories like a monorepo or a control repository.
        default: '.'
        required: false
        type: string

jobs:
  rpmbuild:
    defaults:
      run:
        # Ensure all run: steps are using the same working directory path.
        working-directory: '.'
    runs-on: ubuntu-latest
    strategy:
      fail-fast: true
      matrix:
        images: ['oraclelinux:8']
    container:
      image: ${{ matrix.images }}
    steps:

      - name: Checkout Repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

